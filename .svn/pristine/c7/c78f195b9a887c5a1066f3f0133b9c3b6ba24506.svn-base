<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--  [[개정이력(Modification Information)]]       -->
<!--  수정일         수정자     수정내용               -->
<!--  ==========   ======    ==============        -->
<!--  2023. 11. 21. 전수진     최초작성               -->
<!--  Copyright (c) 2023 by DDIT All right reserved -->


<mapper namespace="kr.or.ddit.groupware.sanction.dao.SanctionLineDAO">

	<!-- 결재라인 생성 -->
	<insert id="insertSanctionLine" parameterType="SanctionLineVO">
	<selectKey order="BEFORE" keyProperty="sanctnLineNo" resultType="String">
	SELECT 
	    'SL'||TO_CHAR(SYSDATE,'YYMMDD')||
	    LPAD(NVL(TO_NUMBER(SUBSTR(MAX(SANCTN_LINE_NO), LENGTH('SL'||TO_CHAR(SYSDATE,'YYMMDD')) + 1)), 0) + 1, 3, '000') 
	FROM
	    SANCTION_LINE
	</selectKey>
		INSERT INTO SANCTION_LINE (
		    SANCTN_LINE_NO 		/* 결재라인번호 */
		    , SANCTN_NO 		/* 결재문서번호 */
		    , SANCTNER 			/* 결재자 */
		    , SANCTN_ORDR		/* 결재순서 */
		    , SANCTN_STTUS 		/* 결재상태 */
		    , SANCTNER_ENDYN 	/* 최종결재자여부 */
		) VALUES (
			  #{sanctnLineNo}
		    , #{sanctnNo}
		    , #{sanctner}
		    , #{sanctnOrdr}
		    , 'I'
		    , #{sanctnerEndyn}
		)
	</insert>
</mapper>